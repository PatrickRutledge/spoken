<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Spoken.App.MainPage"
             Title="Spoken">
    <Grid RowDefinitions="*,Auto" ColumnDefinitions="*">
        <!-- Content -->
        <Grid Grid.Row="0" ColumnDefinitions="320,*" Padding="16">
            <!-- Left Panel: Book List & Passage Selection -->
            <ScrollView Grid.Column="0" Margin="0,0,16,0">
                <VerticalStackLayout Spacing="16">
                    <!-- Passage Selection -->
                    <VerticalStackLayout Spacing="12">
                        <Label Text="Select Passage Range:" FontSize="16" FontAttributes="Bold" />
                        
                        <!-- Start Passage -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="From:" FontSize="14" FontAttributes="Bold" TextColor="{StaticResource Primary}" />
                            <Grid ColumnDefinitions="*,70,70" ColumnSpacing="8">
                                <Picker x:Name="StartBookPicker" Grid.Column="0" Title="Select Book" SelectedIndexChanged="OnStartBookChanged" />
                                <Picker x:Name="StartChapterPicker" Grid.Column="1" Title="Ch" SelectedIndexChanged="OnStartChapterChanged" />
                                <Picker x:Name="StartVersePicker" Grid.Column="2" Title="Vs" SelectedIndexChanged="OnPassageSelectionChanged" />
                            </Grid>
                        </VerticalStackLayout>

                        <!-- End Passage -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="To:" FontSize="14" FontAttributes="Bold" TextColor="{StaticResource Primary}" />
                            <Grid ColumnDefinitions="*,70,70" ColumnSpacing="8">
                                <Picker x:Name="EndBookPicker" Grid.Column="0" Title="Select Book" SelectedIndexChanged="OnEndBookChanged" />
                                <Picker x:Name="EndChapterPicker" Grid.Column="1" Title="Ch" SelectedIndexChanged="OnEndChapterChanged" />
                                <Picker x:Name="EndVersePicker" Grid.Column="2" Title="Vs" SelectedIndexChanged="OnPassageSelectionChanged" />
                            </Grid>
                        </VerticalStackLayout>

                        <!-- Translation & Title -->
                        <VerticalStackLayout Spacing="6">
                            <Label Text="Translation:" FontSize="14" FontAttributes="Bold" />
                            <Picker x:Name="TranslationPicker" SelectedIndexChanged="OnPassageSelectionChanged">
                                <Picker.Items>
                                    <x:String>KJV</x:String>
                                    <x:String>ASV</x:String>
                                </Picker.Items>
                            </Picker>
                            
                            <Label Text="Formatting:" FontSize="14" FontAttributes="Bold" />
                            <Picker x:Name="FormattingModePicker" SelectedIndexChanged="OnFormattingModeChanged">
                                <Picker.Items>
                                    <x:String>Scholarly (USFM)</x:String>
                                    <x:String>AI Thought Groups</x:String>
                                </Picker.Items>
                            </Picker>
                            <Label x:Name="FormattingDescription" FontSize="11" TextColor="Gray" Margin="0,4,0,0" />
                            
                            <!-- Formatting Mode Explanations -->
                            <Frame BackgroundColor="#F0F8FF" Padding="8" HasShadow="False" Margin="0,4,0,0" IsVisible="False" x:Name="FormattingExplanation">
                                <VerticalStackLayout Spacing="8">
                                    <Label FontSize="12" FontAttributes="Bold" Text="Formatting Options:" />
                                    <VerticalStackLayout Spacing="4" x:Name="ScholarlyExplanation">
                                        <Label FontSize="11" FontAttributes="Bold" Text="• Scholarly (USFM):" TextColor="#0066CC" />
                                        <Label FontSize="10" Text="Traditional manuscript-based paragraph breaks using USFM markers. Preserves historical Hebrew/Greek structure and academic integrity." TextColor="Gray" />
                                    </VerticalStackLayout>
                                    <VerticalStackLayout Spacing="4" x:Name="AiExplanation">
                                        <Label FontSize="11" FontAttributes="Bold" Text="• AI Thought Groups:" TextColor="#0066CC" />
                                        <Label FontSize="10" Text="Intelligent grouping based on thematic coherence and narrative flow. Enhances readability for modern readers with natural thought unit breaks." TextColor="Gray" />
                                    </VerticalStackLayout>
                                </VerticalStackLayout>
                            </Frame>
                            
                            <Label Text="Title (optional):" FontSize="14" FontAttributes="Bold" />
                            <Entry x:Name="TitleEntry" Placeholder="Enter a title" TextChanged="OnTitleChanged" />
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Action Buttons -->
                    <VerticalStackLayout Spacing="8">
                        <Button Text="📁 Export PDF" Clicked="OnExportPdfClicked" BackgroundColor="#28A745" TextColor="White"/>
                    </VerticalStackLayout>

                    <!-- Translation Information -->
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Translation Information:" FontSize="14" FontAttributes="Bold" />
                        <Frame BackgroundColor="#F8F9FA" Padding="8" HasShadow="False">
                            <VerticalStackLayout Spacing="12">
                                <VerticalStackLayout Spacing="4">
                                    <Label FontSize="12" FontAttributes="Bold" Text="KJV Cambridge Paragraph Bible" TextColor="#0066CC" />
                                    <Label FontSize="10" Text="The King James Version or Authorized Version of the Holy Bible, Cambridge Paragraph Bible edition" TextColor="Gray" />
                                    <Label FontSize="10" Text="Public Domain • Language: English • Updated: 2020-12-20" TextColor="Gray" />
                                </VerticalStackLayout>
                                <VerticalStackLayout Spacing="4">
                                    <Label FontSize="12" FontAttributes="Bold" Text="American Standard Version (1901)" TextColor="#0066CC" />
                                    <Label FontSize="10" Text="The American Standard Version of the Holy Bible, first published in 1901" TextColor="Gray" />
                                    <Label FontSize="10" Text="Public Domain • Language: English • Dialect: Archaic American" TextColor="Gray" />
                                </VerticalStackLayout>
                            </VerticalStackLayout>
                        </Frame>
                    </VerticalStackLayout>

                    <!-- Book List -->
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Browse Books:" FontSize="16" FontAttributes="Bold" />
                        <Frame BackgroundColor="#F8F9FA" Padding="8" HasShadow="False">
                            <VerticalStackLayout x:Name="BookListPanel" Spacing="2" />
                        </Frame>
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </ScrollView>

            <!-- Right Panel: Preview -->
            <VerticalStackLayout Grid.Column="1" Spacing="12">
                <!-- Preview Header -->
                <HorizontalStackLayout Spacing="16">
                    <Label x:Name="PreviewTitle" Text="Preview" FontSize="18" FontAttributes="Bold" VerticalOptions="Center" />
                    <Label x:Name="PassageReference" Text="Select a passage to preview" FontSize="14" TextColor="Gray" VerticalOptions="Center" />
                </HorizontalStackLayout>

                <!-- Preview Content -->
                <Frame BackgroundColor="White" Padding="0" HasShadow="True">
                    <WebView x:Name="Preview" HeightRequest="500" />
                </Frame>
            </VerticalStackLayout>
        </Grid>

        <!-- Footer -->
        <Grid Grid.Row="1" BackgroundColor="#F8F9FA" Padding="16,8">
            <HorizontalStackLayout Spacing="16">
                <Label x:Name="FooterCitation" Text="Select a passage to view citation" FontSize="12" TextColor="Gray"/>
                <Label Text="·" FontSize="12" TextColor="Gray"/>
                <Label Text="KJV/ASV bundled" FontSize="12" TextColor="Gray"/>
            </HorizontalStackLayout>
        </Grid>
    </Grid>
</ContentPage>
